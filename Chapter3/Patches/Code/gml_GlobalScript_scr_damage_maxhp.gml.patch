--- a/Code/gml_GlobalScript_scr_damage_maxhp.gml
+++ b/Code/gml_GlobalScript_scr_damage_maxhp.gml
@@ -56,39 +56,61 @@
         {
             if (obj_knight_enemy.aoedamage == false)
             {
-                if (target == 0)
-                {
-                    if (global.hp[2] > 0 && global.hp[3] > 0)
-                    {
-                        target = choose(1, 2);
-                    }
-                    else if (global.hp[2] > 0)
-                    {
-                        target = 1;
-                    }
-                    else if (global.hp[3] > 0)
-                    {
-                        target = 2;
+                if (!obj_knight_enemy.krisValid)
+                {
+                    if (global.char[target] < 2)
+                    {
+                        target = choose(0, 1, 2);
+                        repeat (2)
+                        {
+                            if (global.char[target] < 2 || global.hp[global.char[target]] < 1)
+                            {
+                                target++;
+                            }
+                            if (target > 2)
+                            {
+                                target = 0;
+                            }
+                        }
+                    }
+                }
+                else if (global.char[target] < 1)
+                {
+                    target = choose(0, 1, 2);
+                    repeat (2)
+                    {
+                        if (global.char[target] < 1 || global.hp[global.char[target]] < 1)
+                        {
+                            target++;
+                        }
+                        if (target > 2)
+                        {
+                            target = 0;
+                        }
                     }
                 }
                 if (obj_knight_enemy.myattackchoice != 13)
                 {
-                    if (global.chararmor1[1] == 23 || global.chararmor2[1] == 23 || global.chararmor1[2] == 23 || global.chararmor2[2] == 23 || global.chararmor1[3] == 23 || global.chararmor2[3] == 23)
+                    if (scr_armorcheck_equipped_party(23))
                     {
                         obj_knight_enemy.damagecounter++;
                         if (obj_knight_enemy.damagecounter < 3)
                         {
-                            if (global.hp[1] > 0 && (global.chararmor1[1] == 23 || global.chararmor2[1] == 23))
-                            {
-                                target = 0;
-                            }
-                            if (global.hp[2] > 0 && (global.chararmor1[2] == 23 || global.chararmor2[2] == 23))
-                            {
-                                target = 1;
-                            }
-                            if (global.hp[3] > 0 && (global.chararmor1[3] == 23 || global.chararmor2[3] == 23))
-                            {
-                                target = 2;
+                            if (obj_knight_enemy.krisTarget && scr_armorcheck_equipped(1, 23))
+                            {
+                                target = scr_findchar(1);
+                            }
+                            if (obj_knight_enemy.susieTarget && scr_armorcheck_equipped(2, 23))
+                            {
+                                target = scr_findchar(2);
+                            }
+                            if (obj_knight_enemy.ralseiTarget && scr_armorcheck_equipped(3, 23))
+                            {
+                                target = scr_findchar(3);
+                            }
+                            if (obj_knight_enemy.noelleTarget && scr_armorcheck_equipped(4, 23))
+                            {
+                                target = scr_findchar(4);
                             }
                         }
                         else
@@ -96,15 +118,7 @@
                             target = choose(0, 1, 2);
                             repeat (2)
                             {
-                                if (global.hp[1] < 1 && target == 0)
-                                {
-                                    target++;
-                                }
-                                if (global.hp[2] < 1 && target == 1)
-                                {
-                                    target++;
-                                }
-                                if (global.hp[3] < 1 && target == 2)
+                                if (global.char[target] == 0 || global.hp[global.char[target]] < 1)
                                 {
                                     target++;
                                 }
@@ -113,13 +127,7 @@
                                     target = 0;
                                 }
                             }
-                            if (target == 0 && (global.chararmor1[1] == 23 || global.chararmor2[1] == 23))
-                            {
-                            }
-                            else if (target == 1 && (global.chararmor1[2] == 23 || global.chararmor2[2] == 23))
-                            {
-                            }
-                            else if (target == 2 && (global.chararmor1[3] == 23 || global.chararmor2[3] == 23))
+                            if (scr_armorcheck_equipped(global.char[target], 23) == 1)
                             {
                             }
                             else
@@ -129,18 +137,6 @@
                         }
                     }
                 }
-                if (target == 0 && (global.chararmor1[1] == 23 || global.chararmor2[1] == 23))
-                {
-                    arg0 /= 2;
-                }
-                else if (target == 1 && (global.chararmor1[2] == 23 || global.chararmor2[2] == 23))
-                {
-                    arg0 /= 2;
-                }
-                else if (target == 2 && (global.chararmor1[3] == 23 || global.chararmor2[3] == 23))
-                {
-                    arg0 /= 2;
-                }
             }
         }
         var oldcalculation = 0;
@@ -191,9 +187,9 @@
                 {
                     if (global.chapter == 3 && i_ex(obj_knight_enemy))
                     {
-                        if (global.hp[1] < 0)
+                        if (chartarget == 1)
                         {
-                            global.hp[1] = 1;
+                            global.hp[chartarget] = 1;
                             hpdiff = round(global.hp[chartarget] - 1);
                             doomtype = 4;
                             scr_battle_sprite_set("kris", spr_kris_fallen_dark, 0.25, true);
